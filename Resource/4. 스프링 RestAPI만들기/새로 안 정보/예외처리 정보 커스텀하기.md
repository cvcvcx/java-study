---
날짜: 2024-01-05
주제: Spring Boot REST API
설명: 핸들러를 사용해서 예외처리에서 더 많은 정보를 넘길 수 있다
---
> [!NOTE] 사용 시기
> 컨트롤러별로 일일히 에러를 처리할 수도 있지만, 
> 핸들러를 사용해서 일괄적으로 에러가 발생했을 때, 어떤 정보를 넘길지 선택해서 넘길 수 있다.
> 예외 정보 객체와 핸들러를 만든다

> [!tip] 사용방법
> 기본적으로 에러가 발생했을 때, 스프링에서 기본 제공하는 에러 처리 핸들러가 존재한다.
> 그 핸들러를 확장해서, 내가 전달하고 싶은 에러 객체를 리턴할 수 있도록 한다.

# 🚀 구체적인 사용방법
 ```java 
 //ErrorDetails
 //전달하고 싶은 데이터 형식을 지정한 클래스
 @Getter  
@AllArgsConstructor  
public class ErrorDetails {  
    private LocalDateTime timestamp;  
    private String message;  
    private String details;  
}
 ```

```java
//CustomizedResponseEntityExceptionHandler
  
import org.springframework.http.HttpStatus;  
import org.springframework.http.ResponseEntity;  
import org.springframework.web.bind.annotation.ControllerAdvice;  
import org.springframework.web.bind.annotation.ExceptionHandler;  
import org.springframework.web.context.request.WebRequest;  
import org.springframework.web.servlet.mvc.method.annotation.ResponseEntityExceptionHandler;  
  
import java.time.LocalDate;  
import java.time.LocalDateTime;  
//에러처리 핸들러에 붙이는 어노테이션 - 스프링에서 인식하게끔 한다
@ControllerAdvice  
public class CustomizedResponseEntityExceptionHandler extends ResponseEntityExceptionHandler {  
  //모든 종류의 Exception이 발생했을 때, 아래와 같이 새로 에러를 만들어서 반환한다.
    @ExceptionHandler(Exception.class)  
    public final ResponseEntity<Object> handleAllExceptions(Exception ex, WebRequest request){  
        ErrorDetails errorDetails =  
                new ErrorDetails(LocalDateTime.now(),  
                        ex.getMessage(),  
                        request.getDescription(false));  
                        //에러 코드를 지정한다. 이 에러는 예상치못한 서버 에러이기때문에 500
        return new ResponseEntity<>(errorDetails, HttpStatus.INTERNAL_SERVER_ERROR);  
    }  
    //유저가 없을 경우 발생하는 에러를 핸들링한다
@ExceptionHandler(UserNotFoundException.class)  
public final ResponseEntity<Object> handleUserNotFoundExceptions(Exception ex, WebRequest request){  
    ErrorDetails errorDetails =  
            new ErrorDetails(LocalDateTime.now(),  
                    ex.getMessage(),  
                    request.getDescription(false));  
                    //응답 코드를 404로 바꿔 전달한다.
    return new ResponseEntity<>(errorDetails, HttpStatus.NOT_FOUND);  
}
  
}
```

## 🚀 응답결과
![](https://i.imgur.com/CQDQSWw.png)
Body부분을 보면 제대로 결과값이 커스텀한대로 반환되고있는 것을 볼 수 있다.

> [!warning] 주의 사항

